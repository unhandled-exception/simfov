C
	SUBROUTINE CAHORT(CBB,ADAL,DA123,W,
     *			IRTERM,IARGW,AMPW,BSCW,MCSU,
     *			T,UT,VT,DDU,DDL)
	IMPLICIT REAL*8(A-H,O-Z),INTEGER*2(I-N)
	DIMENSION CBB(50),ADAL(30,3),FQ(5),CQ(9),SQ(9),
     *		CB(50),DA123(3,4),W(3),EL(3),YY(4),
     *		UT(3),VT(3),DV(3)
	DIMENSION DPS(6),DFI(6),DUZ(6),DUR(6),CU(9,16),SU(9,16),
     *		RW(4),DDL(3),DDU(3),IUG(9),MCSU(9),RWW(3)
	DIMENSION IARGW(2000,9),AMPW(2000,4)
	CHARACTER BSCW(2000),BOS
	DATA PI22/6.283185307179586D0/
C
	IF (IRTERM.EQ.0) RETURN
	O=1.D0
	OL=0.D0
	WW=2.D0
	ND=4
	GG=360.D0
	GR=PI22/GG
	RADGRA=1.D0/GR
	DO 8 J=1,50
    8		CB(J)=CBB(J)
C
	DO 88 J=1,3
   88		DV(J)=VT(J)-W(J)
C
	CALL CARTER(DV,YY)
C
	CALL CARTOT(YY,DA123,EL)
C
	AB=CB(8)
	AE=CB(9)
	AS=CB(10)
	AC=CB(11)
	AD=CB(12)
	ADZ=CB(13)
	AX=CB(14)
	AG=CB(15)
	AT=CB(16)
	AG1=CB(17)
	AG2=CB(18)
	AN=CB(19)
	AQ=CB(20)
	AC0=CB(21)
	AC1=CB(22)
	AC2=CB(23)
	AC3=CB(24)
	AC4=CB(25)
	AK1=CB(26)
	AK2=CB(27)
	AQ0=CB(28)
	AQ1=CB(29)
	AQ2=CB(30)
	AZ=CB(31)
	AP0=CB(32)
	AP1=CB(33)
	AP2=CB(34)
	AF0=CB(35)
	AF1=CB(36)
	AF2=CB(37)
	AF3=CB(38)
	AF4=CB(39)
	ALAM=CB(40)
	AN0=CB(41)
	OH= CB(45)
	AMU=CB(46)
	AKF2=CB(47)
	AKF4=CB(48)
	AKP2=CB(49)
	AKP4=CB(50)
C
	RA=1.D0-AX**2
	RX=DSQRT(RA)
C
	EDL=VT(1)
	EDG=VT(2)
	EDH=VT(3)
C
	UL=UT(1)
	UG=UT(2)
	UH=UT(3)
C
	UDL=DMOD(UL,PI22)
	UDG=DMOD(UG,PI22)
	UDH=DMOD(UH,PI22)
C
	SP=DSIN(UDL)
	SE=SP
	CP=DCOS(UDL)
	CE=CP
	SF=OL
	CF=O
	EP=UDL
	EA=EP
	DO 11 J=1,15
		PUDL=EP-UDL
		SPP=WW*SP*CP
		CPP=CP**2-SP**2
		SPR=WW*SPP*CPP
		SFF=WW*SF*CF
		SF3=SF*CFF+CF*SFF
		CFF=CF**2-SF**2
		SFR=WW*SFF*CFF
		EE=UDL+AZ*SE+ALAM*PUDL-AP1*SP-AP2*SPP
     *		-AF1*SF+AF2*SFF+AF3*SF3-AF4*SFR
		SE=DSIN(EE)
		CE=DCOS(EE)
		RB=O/(O-AX*CE)
		SP=RX*RB*SE
		CP=(CE-AX)*RB
		EP=EE+DATAN((SP*CE-CP*SE)/(CP*CE+SP*SE))
	EF=EP+UDG+OH*PUDL+AKP2*SPP+AKP4*SPR-AKF2*SFF+AKF4*SFR
		SF=DSIN(EF)
		CF=DCOS(EF)
	IF (DABS(EA-EE).LT.1.D-10) GO TO 111
   11		EA=EE
C
  111	SP3=SP*CPP+CP*SPP
	CP3=CP*CPP-SP*SPP
	CF3=CF*CFF-SF*SFF
	CP4=CPP**2-SPP**2
	CF4=CFF**2-SFF**2
C
	AU=UDH+AMU*PUDL+AC1*SP+AC2*SPP+AC3*SP3+AC4*SPR
     *		+AQ1*SF-AQ2*SFF
C
	CQ(1)=CF
	SQ(1)=SF
	CQ(2)=CP
	SQ(2)=SP
	COSAU=DCOS(AU)
	SINAU=DSIN(AU)
	CQ(3)=COSAU
	SQ(3)=SINAU
C
      T40000=T-40000.D0
      AJ=IDINT(T40000)+40000.D0
      S=T-AJ
      AJ=AJ-15019.5D0
      R=DMOD(AJ/365.25D0,1.D0)
      AJS=AJ/36525.D0
      S0=(.13420272950897D-1+.6755878646D-5*AJS)*AJS
      S0=S0+1.73993589371745D0+R*PI22
      S0=S0+1.002737909255831D0*S*PI22
      IF (S0.GT.PI22) S0=DMOD(S0,PI22)
C
	CQ(4)=DCOS(S0)
	SQ(4)=DSIN(S0)
C
	DT=(T-4.1D4)/3.6525D4
	FILA=239.809655D0+481267.883142D0*DT
	FQ(1)=GR*DMOD(FILA,GG)
	FIL=251.151564D0+477198.849108D0*DT
	FQ(2)=GR*DMOD(FIL,GG)
	FILS= 44.863949D0+ 35999.049750D0*DT
	FQ(3)=GR*DMOD(FILS,GG)
	FIF=276.394730D0+483202.025150D0*DT
	FQ(4)=GR*DMOD(FIF,GG)
	FID=272.501771D0+445267.114217D0*DT
	FQ(5)=GR*DMOD(FID,GG)
C
	DO 3242 J=1,5
		JJ=J+4
		CQ(JJ)=DCOS(FQ(J))
 3242		SQ(JJ)=DSIN(FQ(J))
C
	DO 9017 J=1,9
		QC=CQ(J)
		QS=SQ(J)
		CU(J,1)=QC
		SU(J,1)=QS
		VC=QC
		VS=QS
		MCSUJ=MCSU(J)
		IF (MCSUJ.LE.1) GO TO 91718
		DO 91717 I=2,MCSUJ
			UC=VC*QC-VS*QS
			US=VS*QC+VC*QS
			CU(J,I)=UC
			SU(J,I)=US
			VC=UC
			VS=US
91717		CONTINUE
91718		CONTINUE
 9017	CONTINUE
C
C derivatives :
C
	RKP=+2.D0*AKP2*CPP+4.D0*AKP4*CP4
	RKF=-2.D0*AKF2*CFF+4.D0*AKF4*CF4
	RKP=AN+RKP
	RKF=O/(O-RKF)
	RGP=+AP1*CP*2.D0*AP2*CPP
	RGF=+AF1*CF-2.D0*AF2*CFF-3.D0*AF3*CF3+4.D0*AF4*CF4
	ROP=+AC1*CP+2.D0*AC2*CPP+3.D0*AC3*CP3+4.D0*AC4*CP4
	ROF=+AQ1*CF-2.D0*AQ2*CFF
	RXX=(O-AX*CE)*(O-AZ*CE)/RX-ALAM+RGP+RKP*RKF*RGF
	RXX=O/RXX
	DPS(4)=+RXX*(O-ALAM+OH*RKF*RGF)
	DPS(5)=-RXX*RKF*RGF
	DPS(6)=OL
	DFI(4)=-OH*RKF+RKP*RKF*DPS(4)
	DFI(5)=+RKF+RKP*RKF*DPS(5)
	DFI(6)=OL
	DUZ(4)=-AMU+(AMU+ROP)*DPS(4)+ROF*DFI(4)
	DUZ(5)= (AMU+ROP)*DPS(5)+ROF*DFI(5)
	DUZ(6)=+O
C
	QE=SE*(O-AZ*CE)/(O-AX**2)
	DO 30 I=1,3
		R2=-ADAL(27,I)*SFF
		R3=ADAL(30,I)*SPP
		R4=-ADAL(29,I)*SFF
		R7=ADAL(28,I)*PUDL-R2
		R8=ADAL(23,I)*PUDL+R3+R4
		R9=QE*ADAL(8,I)+SE*ADAL(21,I)
		DPS(I)=RXX*(R7-RKF*RGF*R8+R9)
		DFI(I)=RKP*RKF*DPS(I)+RKF*R8
   30		DUZ(I)=ADAL(24,I)*PUDL+(AMU+ROP)*DPS(I)+ROF*DFI(I)
C
	DO 24 I=1,3
		DDL(I)=0.D0
   24		DDU(I)=0.D0
C
	IRW=0
 1000	CONTINUE
	IRW=IRW+1
	IF (IRW.GT.IRTERM) GO TO 1001
C
	DO 1662 I=1,9
 1662		IUG(I)=IARGW(IRW,I)
C
	DO 555 K=1,ND
  555		RW(K)=AMPW(IRW,K)
	BOS=BSCW(IRW)
C
	DO 15 J=1,6
   15		DUR(J)=IUG(1)*DFI(J)+IUG(2)*DPS(J)+IUG(3)*DUZ(J)
C
	CA=1.D0
	SA=0.D0
	DO 18 J=1,9
		IU=IUG(J)
		IF (IU.EQ.0) GO TO 19
		IZ=1
		IF (IU.LT.0) IZ=-1
		IU=IZ*IU
		UC=CU(J,IU)
		US=SU(J,IU)
		CP=CA
		SB=SA
		CA=CP*UC-IZ*SB*US
		SA=SB*UC+IZ*CP*US
   19		CONTINUE
   18	CONTINUE
C
		CALL CARFUT(YY,RW,RWWW,RWW)
C
	IF (BOS.EQ.'C') GO TO 20
	R1=CA*RWWW
	R2=SA
	GO TO 21
   20	R1=-SA*RWWW
	R2=CA
   21	CONTINUE
	DO 22 I=1,3
		II=I+3
		DDL(I)=DDL(I)+R1*DUR(II)
   22		DDU(I)=DDU(I)-R2*RWW(I)-R1*DUR(I)
C
	GO TO 1000
 1001	CONTINUE
C
C	(DA* AND DU*) ARE (OSCULATE-MEAN) ELEMENTS
C
	RETURN
	END
c
      SUBROUTINE EREMA(FM,CJ2,SIG,AN0,AE,AI,C)
      IMPLICIT REAL*8(A-H,O-Z),INTEGER*2(I-N)
      DIMENSION C(50)
	DATA PI22/6.283185307179586D0/
      GR=PI22/360.D0
      S=GR*AI
      AS=DSIN(S)  
      AC=DCOS(S)
      AD=AS
      ADZ=-AS
C      FM=3.9860047D14
C      CJ2=2.09728864D5
C      SIG=-3.561343144D-2
      A1=-(FM*AN0)**(0.666666666666667D0)
      F0=-FM/A1
      AB=F0
      FC=CJ2/F0
      RE=1.D0-AE**2
      F1=2.D0-RE
      F2=RE**2
      DO 1 J=1,7
         PE=CJ2/(AB*RE)
         P2=PE**2
         P4=P2**2
         PS=PE*SIG
         D2=AD**2
         RD=1.D0-D2
         D4=D2**2
         RC=1.D0-2.D0*PS*AD-P2*D2*RE
         RR=1.D0+2.D0*P2*D2*F1+P4*D4*F2
         R1=RC/RR
         F3=1.D0-RD*R1
         AB=F0*(1.D0-P2*RE*RD*R1)
         DZ2=ADZ**2
         RDZ=1.D0-DZ2
         DZ4=DZ2**2
         RCZ=1.D0-2.D0*PS*ADZ-P2*DZ2*RE
         RRZ=1.D0+2.D0*P2*DZ2*F1+P4*DZ4*F2
         R2=RCZ/RRZ
         F4=1.D0-RDZ*R2
         F5=F3+D2*ADZ*(FC*PE*(2.D0*AD+ADZ)+2.D0*PS)
         F6= F4+DZ2*AD*(FC*PE*(2.D0*ADZ+AD)+2.D0*PS)
         F7=DSQRT((F5/F6)*(F4/F3))
         F9=R1/R2
         F8=2.D0*F7*(1.D0+F7)*F9*AS
         ADZ=(-1.D0+F9-F9*((1.D0+F7)*AS)**2
     *       +(1.D0-F9*F7**2)*DZ2)/F8
         AD=AS*(1.D0+F7)+F7*ADZ
    1 CONTINUE
      R3=FM*AB*RE*RD*(1.D0+2.D0*P2*F1+P4*F2)*R1
      R4=FM*AB*RE*RDZ*(1.D0+2.D0*P2*F1+P4*F2)*R2
      A3=DSQRT(R3)
      IF (AC.LT.0.D0) A3=-A3
      A2=-FM*AB*RE*(1.D0+2.D0*P2*F1*RD*R1+P4*F2*RD*R1)
      C(8)=AB
      C(9)=AE   
      C(10)=AS
      C(11)=AC
      C(5)=A1
      C(6)=A2
      C(7)=A3
      C(12)=AD
      C(13)=ADZ
	C(1)=FM
	C(3)=CJ2
	C(4)=SIG
      C(41)=AN0
      RETURN
      END     
c
	SUBROUTINE PARMB(C,ADAL)
	IMPLICIT REAL*8(A-H,O-Z),INTEGER*2(I-N)
	DIMENSION C(50),ADAL(30,3),QQ(3),X(2),
     *	DA(3),DE(3),DF(3),DG(3),
     *	DK2(3),DAX(3),
     *	P(2),DP(2,3),DS(2,3),DD(3,3)
	FM=C(1)
	RZ=C(2)
	CJ2=C(3)
	SIG=C(4)
	A1=C(5)
	A2=C(6)
	A3=C(7)
	AB=C(8)
	AE=C(9)
	AS=C(10)
	AC=C(11)
	AD=C(12)
	ADZ=C(13)
	AX=C(14)
	AG=C(15)
	AT=C(16)
	AG1=C(17)
	AG2=C(18)
	AN=C(19)
	AQ=C(20)
	AC0=C(21)
	AC1=C(22)
	AC2=C(23)
	AK1=C(26)
	AK2=C(27)
	AQ0=C(28)
	AQ1=C(29)
	AQ2=C(30)
	AZ=C(31)
	AP0=C(32)
	AP1=C(33)
	AP2=C(34)
	AF0=C(35)
	AF1=C(36)
	AF2=C(37)
	ALAM=C(40)
	AN0=C(41)
	ANU=C(45)
	AMU=C(46)
	R1=1.0D0+AP0+AN*AF0
	R2=1.0D0/R1
	R3=AN0*R2
	ADAL(1,1)=R3
	ADAL(1,2)=R3*(AN-1.0D0)
	ADAL(1,3)=R3*(AC0+AN*AQ0)
	R4=8.D0*AK1
	R6=1.D0
	R5=1.0D0
	DO 1 J=1,5
		R7=2.D0*J
		R7=(R7-1.0D0)/R7
	        R5=R4*R5*R7**2
    1		R6=R6+R5
	R4=2.D0*AG1*R2/R6
	ADAL(2,1)=-R4*AF0
	ADAL(2,2)=R4*(1.0D0+AP0+AF0)
	ADAL(2,3)=R4*(AQ0+AP0*AQ0-AF0*AC0)
	Z2=CJ2**2
	Z0=CJ2*SIG
	DO 100 I=1,2
		DO 100 J=1,3
  100		DD(I,J)=ADAL(I,J)
	DD(3,1)=0.D0
	DD(3,2)=0.D0
	DD(3,3)=2.D0*A3
	X(1)=AB*(1.D0-AE)
	X(2)=AB*(1.D0+AE)
	R1=4.D0*A1
	R2=6.D0*FM
	R3=2.D0*(A1*Z2+A2)
	R4=2.D0*FM*Z2
	FA=1.0D0/A1
	F1=2.D0*(FM*FA+AB)
	F3=1.0D0/(X(1)*X(2))
	F2=Z2*(A3**2+A2)*F3*FA
	DO 101 J=1,2
		X2=X(J)**2
	X3=X(J)*X2
	X4=X2+Z2
	R=R1*X3+R2*X2+R3*X(J)+R4
	R=1.0D0/R
	P(J)=DSQRT(X2+X(J)*F1+F2)
	DS(J,3)=-Z2*R
	DS(J,2)=X4*R
  101		DS(J,1)=-2.D0*X2*DS(J,2)
	DO 102 I=1,3
		DA(I)=0.5D0*(DS(1,I)+DS(2,I))
  102	DE(I)=0.5D0*((1.D0-AE)*DS(2,I)-(1.D0+AE)*DS(1,I))/AB
	F4=Z2*FA*F3
	DF(1)=-2.D0*F2*FA-F2*F3*(X(1)*DS(2,1)+X(2)*DS(1,1))
	DF(2)=-F4-F2*F3*(X(1)*DS(2,2)+X(2)*DS(1,2))
	DF(3)= F4-F2*F3*(X(1)*DS(2,3)+X(2)*DS(1,3))
	QQ(1)=1.0D0
	QQ(2)=0.D0
	QQ(3)=0.D0
	DO 103 J=1,2
		Q=4*FM*FA*FA*X(J)
		DO 103 I=1,3
	DP(J,I)=0.5D0*((2.D0*X(J)+F1)*DS(J,I)
     *		+2.D0*X(J)*DA(I)+DF(I)-Q*QQ(I))/P(J)
  103	CONTINUE
	G=0.5D0/AG2
	Q1=-2.D0*P(1)*P(2)
	Q2=0.5D0*(X(2)-X(1))
	Q3=0.5D0*(P(2)-P(1))
	Q4=-2.D0/Q1
	Q6=1.D0/(P(1)+P(2))
	Q5=(1.D0-AX)*Q6
	Q6=(1.D0+AX)*Q6
	DO 104 I=1,3
		R=P(2)*DP(1,I)+P(1)*DP(2,I)
		DG(I)=G*(-A1*R+Q1*QQ(I))
		DK2(I)=(Q2*(DS(2,I)-DS(1,I))
     *		-Q3*(DP(2,I)-DP(1,I))-8.D0*AK2*R)*Q4
  104		DAX(I)=Q5*DP(2,I)-Q6*DP(1,I)
	E1=1.0D0/(1.0D0-AE*AX)
	AXPE=AE*(1.D0-AX)*E1
	AXPQ=(AX-AE)*E1
	DO 105 I=1,3
	   S1=0.D0
	   S2=0.D0
	   RA=0.D0
	   RE=0.D0
	   RG=0.D0
	   RK=0.D0
	   RX=0.0D0
		DO 106 J=1,3
	R=DD(J,I)
        S1=S1+DS(1,J)*R
	S2=S2+DS(2,J)*R
        RA=RA+DA(J)*R
	RE=RE+DE(J)*R
	RG=RG+DG(J)*R
        RK=RK+DK2(J)*R
  106	RX=RX+DAX(J)*R
		ADAL(13,I)=S1
		ADAL(14,I)=S2
		ADAL(3,I)=RA
		ADAL(4,I)=RE
		ADAL(7,I)=RG
		ADAL(8,I)=RX
		ADAL(10,I)=RK
	ADAL(17,I)=E1*((1.D0-AX)*RE-AE*RX+AXPE*(AE*RX+AX*RE))
  105		ADAL(18,I)=E1*(RX-RE+AXPQ*(AE*RX+AX*RE))
	RETURN
	END
C
	SUBROUTINE PARMC(C,ADAL)
	IMPLICIT REAL*8(A-H,O-Z),INTEGER*2(I-N)
	DIMENSION C(50),ADAL(30,3),QQ(3),X(2),
     *	DF(3),DG1(3),DK1(3),
     *	DDS(3),DDT(3),DDG(3),
     *	P(2),DP(2,3),DS(2,3),DD(3,3)
	FM=C(1)
	RZ=C(2)
	CJ2=C(3)
	SIG=C(4)
	A1=C(5)
	A2=C(6)
	A3=C(7)
	AB=C(8)
	AE=C(9)
	AS=C(10)
	AC=C(11)
	AD=C(12)
	ADZ=C(13)
	AX=C(14)
	AG=C(15)
	AT=C(16)
	AG1=C(17)
	AG2=C(18)
	AN=C(19)
	AQ=C(20)
	AC0=C(21)
	AC1=C(22)
	AC2=C(23)
	AK1=C(26)
	AK2=C(27)
	AQ0=C(28)
	AQ1=C(29)
	AQ2=C(30)
	AZ=C(31)
	AP0=C(32)
	AP1=C(33)
	AP2=C(34)
	AF0=C(35)
	AF1=C(36)
	AF2=C(37)
	ALAM=C(40)
	AN0=C(41)
	ANU=C(45)
	AMU=C(46)
	R1=1.0D0+AP0+AN*AF0
	R2=1.0D0/R1
	R3=AN0*R2
	ADAL(1,1)=R3
	ADAL(1,2)=R3*(AN-1.0D0)
	ADAL(1,3)=R3*(AC0+AN*AQ0)
	R4=8.D0*AK1
	R6=1.D0
	R5=1.0D0
	DO 1 J=1,5
		R7=2.D0*J
		R7=(R7-1.0D0)/R7
	        R5=R4*R5*R7**2
    1		R6=R6+R5
	R4=2.D0*AG1*R2/R6
	ADAL(2,1)=-R4*AF0
	ADAL(2,2)=R4*(1.0D0+AP0+AF0)
	ADAL(2,3)=R4*(AQ0+AP0*AQ0-AF0*AC0)
	Z2=CJ2**2
	Z0=CJ2*SIG
	DO 100 I=1,2
		DO 100 J=1,3
  100		DD(I,J)=ADAL(I,J)
	DD(3,1)=0.D0
	DD(3,2)=0.D0
	DD(3,3)=2.D0*A3
	R1=4.D0*A1
	R2=6.D0*FM
	R3=2.D0*(A1*Z2+A2)
	R4=2.D0*FM*Z2
	FA=1.0D0/A1
	X(1)=ADZ
	X(2)=AD
	R1=-R1*Z2
	R2=R2*Z0
	R4=-2.D0*FM*Z0
	F5=AD*ADZ
	F3=1.0D0/F5
	F6=FA/Z2
	F1=-R4*F6
	F2=-(A3**2+A2)*F6*F3
	DO 107 J=1,2
		X2=X(J)**2
		X3=X(J)*X2
		X4=1.D0-X2
		R=R1*X3+R2*X2+R3*X(J)+R4
		R=1.0D0/R
		P(J)=DSQRT(F2+F1*X(J)-2.D0*X2-F5)
		DS(J,3)=R
		DS(J,2)=-X4*R
  107		DS(J,1)=2.D0*Z2*X2*DS(J,2)
	F4=F2*F3
	F7=X(1)*DS(2,1)+X(2)*DS(1,1)
	DF(1)=2.D0*F2*FA+F4*F7+F7
	F8=X(1)*DS(2,2)+X(2)*DS(1,2)
	DF(2)=-F6*F3+F4*F8+F8
	F9=X(1)*DS(2,3)+X(2)*DS(1,3)
	DF(3)=F6*F3+F4*F9+F9
	QQ(1)=1.0D0
	QQ(2)=0.D0
	QQ(3)=0.D0
	DO 108 J=1,2
		Q=-2.D0*F1*FA*X(J)
		DO 108 I=1,3
	DP(J,I)=0.5D0*(-DF(I)
     *		+Q*QQ(I)+(F1-4.D0*X(J))*DS(J,I))/P(J)
  108	CONTINUE	
	Q3=P(1)*P(2)
	Q1=1.0D0/Q3
	Q2=1.0D0/(P(1)+P(2))
	PX=X(2)-X(1)
	PM=P(2)-P(1)
	Q0=0.25D0*Q1*(PX**2+PM**2)
	Q=1.0D0+Q0
	Q4=P(2)*Q
	Q5=P(1)*Q
	Q6=1.0D0/Q**2
	G=-0.5D0*A1*Z2/AG1
	DO 109 I=1,3
	D=0.5D0*Q1*(PX*(DS(2,I)-DS(1,I))
     *		+PM*(DP(2,I)-DP(1,I)))
	D=D-Q0*Q1*(P(2)*DP(1,I)+P(1)*DP(2,I))
		DK1(I)=Q6*D
		DG1(I)=G*(Q3*D+Q4*DP(1,I)+Q5*DP(2,I))
		DDS(I)=Q2*(P(1)*DS(2,I)-P(2)*DS(1,I)
     *		+(AD-AS)*DP(1,I)-(ADZ+AS)*DP(2,I))
		DDT(I)=Q2*((1.D0-AT)*DP(1,I)
     *		-(1.D0+AT)*DP(2,I))
		DDG(I)=Q2*(P(2)*DS(1,I)+P(1)*DS(2,I)
     *		+(AD-AG)*DP(1,I)+(ADZ-AG)*DP(2,I))
  109	CONTINUE
	DG1(1)=DG1(1)+AG1*FA
	ADFS=P(1)*PX*Q2
	DO 110 I=1,3
	   S1=0.D0
	   S2=0.D0
	   RS=0.D0
	   RG=0.D0
	   RK=0.D0
	   RT=0.D0
	   RX=0.D0
	   RP=0.D0
	   RQ=0.0D0
		DO 111 J=1,3
	R=DD(J,I)
	S1=S1+DS(1,J)*R
	S2=S2+DS(2,J)*R
	RS=RS+DDS(J)*R
	RG=RG+DG1(J)*R
	RK=RK+DK1(J)*R
	RT=RT+DDT(J)*R
	RP=RP+DP(1,J)*R
	RQ=RQ+DP(2,J)*R
  111	RX=RX+DDG(J)*R
	ADAL(5,I)=RS
	ADAL(6,I)=RG
        ADAL(9,I)=RK
	ADAL(11,I)=RT
	ADAL(12,I)=RX
	ADAL(15,I)=S1
	ADAL(16,I)=S2
  110	ADAL(19,I)=Q2*(PM*(RP-P(1)*Q2*(RQ+RP))+P(1)*(S2-S1))
	R1=1.D0/AB
	X2=AE*AE
	S1=AS*AS
	S2=S1*S1
	RE=1.D0-X2
	RX=DSQRT(RE)
	RQ=RE*RX
	RE=1.D0/RE
	Q1=CJ2*R1*RE
	Q2=Q1*Q1
	Q4=Q2*Q2
	R2=2.D0*AE*RE
	R3=AZ*R1
	R4=AZ/AE
	RA=2.D0*AZ*FA
	RK=3.D0*AN0*FA
	F1=AN/AG1
	F3=0.25D0*AN*(1.D0+9.D0*AK2)
	F3=F3/(1.D0+2.D0*AK2+9.D0*AK2**2)
	F2=AN/AG2
	F4=0.25D0*AN*(1.D0+9.D0*AK1)
	F4=F4/(1.D0+2.D0*AK1+9.D0*AK1**2)
	R=6.D0-17.D0*S1-24.D0*X2*S1
	G=1.D0+SIG**2
	D=-AS/AC
	F5=2.D0*SIG
	F6=8.D0-32.D0*S1+25.D0*S2
	F7=-1.500000D0*(Q2*G+0.125D0*Q4*R)
	F8=-1.5000000D0*AC*(G+0.25D0*Q2*R)
	F9=0.37500000D0*Q4*AC*AS
	Q3=-0.3750000D0*Q2*RQ*F6
	Q5=0.56250D0*Q4*AE*RX*F6
	Q6=0.75000000D0*Q4*RQ*AS*(16.D0-25.D0*S1)
	DO 112 I=1,3
		PX=ADAL(1,I)
		PM=ADAL(3,I)
		X3=ADAL(4,I)
		X4=ADAL(5,I)
		Q=Q1*(-R1*PM+R2*X3)
		Q0=2.D0*Q1*Q
		ADAL(20,I)=Q0
		E1=D*X4
		ADAL(21,I)=R3*PM+R4*X3+RA*PX
		ADAL(22,I)=RK*PX
		ADAL(23,I)=F1*ADAL(6,I)-F2*ADAL(7,I)
     *		+F3*ADAL(10,I)-F4*ADAL(9,I)
		ADAL(24,I)=F7*E1+F8*Q0
     *		+F9*(17.D0-24.D0*X2)*X4+F9*24*AE*AS*X3
		ADAL(25,I)=E1
		ADAL(26,I)=F5*(AC*AS*Q+Q1*AS*E1+Q1*AC*X4)
		ADAL(27,I)=-0.250000000D0*S1*RQ*Q0
     *	-0.500D0*Q2*AS*RQ*X4+0.7500D0*Q2*S1*AE*RX*X3
		ADAL(28,I)=Q3*Q0+Q5*X3+Q6*X4
		ADAL(29,I)=0.125D0*ADAL(9,I)
  112		ADAL(30,I)=-0.125D0*ADAL(10,I)
	RETURN
	END