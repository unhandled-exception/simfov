	SUBROUTINE PCMZON(CC,ADFI,PFU,RMIN,W,V,UVC,A,B,G)
	IMPLICIT REAL*8(A-H,O-Z),INTEGER*2(I-N)
	DIMENSION CC(50),UVC(4,96),RW(4),A(4,220),B(4,220),
     *		G(4,20),ADFI(4,24),PFU(4,60),W(4,90),V(4,240)
	CHARACTER BSAT(60),BCS,BSC
C
	MFIW=16
	MPSIW=6
	MAXPSI=6
	MAXFI=16
	MAXKSI=15
	MAXETA=15
	MINFI=-4
	MAPA=2*MAXPSI-1
	MIF=MAXFI-MINFI
	MAPF=MIF*MAPA
	MPIF=MFIW*MPSIW
	MW=MPSIW*MAXKSI
	MV=MFIW*MAXETA
	MPUF=4*MAPA+16
	MKSI=14
	META=15
C
C DIMENSIONS OF W IS 4 * MPSIW*MAXKSI
C DIMENSIONS OF V IS 4 * MFIW*MAXETA
C DIMENSIONS OF UVC IS 4 * (MFIW*MPSIW)
C
	FREZ=0.72921158E-4
	FREQ=FREZ/55.5
	FREQ=CC(8)**2*FREQ
C
	ILA=0
	IL=0
	ILS=0
	IF=0
	ID=0
C
	OPEN(UNIT=14,FILE='ZONT.PGM',
     *		STATUS='OLD',ERR=5213)
	GO TO 5214
 5213	PRINT *,'no File  ZONT.PGM'
	RETURN
C
 5214	CONTINUE
C
	READ(14,5262) BSAT
 5262	FORMAT(60A1)
 5263	FORMAT(1X,60A1)
	IEND=0
	DO 102 K=1,4
		DO 102 I=1,MPIF
  102			UVC(K,I)=0.
C
    1	CONTINUE
	READ(14,41,END=303) MM,NS,KE,CAS
   41	FORMAT(3I3,2D20.11)
	CAS=1.D-12*CAS
	IF (NS.LT.0) NS=-NS
	IF (MM.GT.0) GO TO 304
	IF ((NS.GT.MKSI).OR.(KE.GT.META)) GO TO 1
C
	CALL KSITAP(NS,KE,CAS,W,V,UVC)
	GO TO 1
C
  304	CONTINUE
  303	CONTINUE
C
	NTERM=0
	NTERS=0
C
		BCS='C'
		BSC='S'
C
	DO 509 K=1,4
		DO 509 I=1,MAPF
                  IF (I.LE.MIF) G(K,I)=0.
			A(K,I)=0.
  509			B(K,I)=0.
C
	IRM=0
	IRA=0
C
	II=-MINFI*MAPA-MAXPSI+1
	IW=0
	DO 108 I=1,MFIW
		II=II+MAPA
		DO 108 I2=1,MPSIW
	I4=II+I2-1
	I5=II-I2+1
	IW=IW+1
			DO 109 K=1,4
		R=UVC(K,IW)
		A(K,I4)=R
		IF (I2.NE.1) A(K,I5)=R
  109			CONTINUE
  108	CONTINUE
C
	RA=0.
C
	CALL KENGP(IRM,RA,A,B,ADFI,FREQ,PFU,IAN,G)
C
	IFI=MINFI
	IPS=-MAXPSI
	DO 211 I=1,MAPF
		IPS=IPS+1
		IF (IPS.LT.MAXPSI) GO TO 212
		IPS=-MAXPSI+1
		IFI=IFI+1
  212		CONTINUE
		DO 221 K=1,4
			RW(K)=B(K,I)
		IF (BCS.EQ.'S') RW(K)=-RW(K)
  221		CONTINUE
C
            DO 521 K=2,4
                  R=DABS(RW(K))
                  IF (R.GT.RMIN) GO TO 522
  521       CONTINUE
                  GO TO 213
  522       CONTINUE
   47	FORMAT(1X,9I3,1P,4E12.3,2X,A1)
	WRITE(15) IFI,IPS,IRM,IRA,
     *		ILA,IL,ILS,IF,ID,
     *		(RW(K),K=1,4),BSC
		NTERM=NTERM+1
  213		CONTINUE
  211	CONTINUE
C
C SEQULAR PERTURBATIONS: NEW FUNCTION
C
	IFI=MINFI-1
	DO 214 I=1,MIF
		IFI=IFI+1
		IPER=IFI
            DO 524 K=2,4
                  R=DABS(G(K,I))
      		IF (R.GT.1.E-18) GO TO 525
  524       CONTINUE
                  GO TO 526
  525       CONTINUE
	WRITE(16) IAN,IPER,IRM,IRA,
     *		ILA,IL,ILS,IF,ID,
     *		(G(K,I),K=1,4),BCS
            NTERS=NTERS+1
  526       CONTINUE
  214	CONTINUE
C
	PRINT 6665,NTERM
	WRITE(17,6665) NTERM
 6665	FORMAT(1X,'in file CTAC.DAT are added',I6,' short terms')
	PRINT 7665,NTERS
	WRITE(17,7665) NTERS
 7665	FORMAT(1X,'in File CTAC.SEQ are added',I6,'  long terms')
	CLOSE(UNIT=14)
	RETURN
	END
C
	SUBROUTINE PCMTES(CC,ADFI,PFU,RMIN,
     *		W,V,C,S,UVC,UVS,WC,WS,A,B,G)
	IMPLICIT REAL*8(A-H,O-Z),INTEGER*2(I-N)
	DIMENSION W(4,90),V(4,240),UVC(4,96),UVS(4,96),
     *		WC(4,96),WS(4,96),
     *		C(4,240),S(4,240),CC(50),RW(4),G(4,20),
     *		A(4,220),B(4,220),ADFI(4,24),PFU(4,60)
	CHARACTER BSAT(60),BCS,BSC
C
	MPSIW=6
	MFIW=16
	MAPF=MPSIW*MFIW
	MAXPSI=6
	MAPA=2*MAXPSI-1
	MAXFI=16
	MINFI=-4
	MIFI=MAXFI-MINFI
	MAPU=MIFI*MAPA
	MKSI=14
	META=15
	MCSW=15
	QAR=CC(8)/CC(2)
	IF (QAR.GT.5.D0) MKSI=10
	IF (QAR.GT.5.D0) META=11
	IF (QAR.GT.5.D0) MCSW=11
C
	FREZ=0.72921158E-4
	FREQ=FREZ/55.5E0
C
	ILA=0
	IL=0
	ILS=0
	IF=0
	ID=0
C
	FREQ=CC(8)**2*FREQ
C
   45	FORMAT(18A1)
C
	OPEN(UNIT=14,FILE='TEST.PGM',STATUS='OLD',ERR=5213)
	GO TO 5214
 5213	PRINT *,'no File TEST.PGM'
	RETURN
 5214	CONTINUE
C
	READ(14,5262) BSAT
 5262	FORMAT(60A1)
 5263	FORMAT(1X,60A1)
C
	NTERM=0
	NTERS=0
	BCS='C'
	BSC='S'
C
	IEND=0
	INM=-1
    1	CONTINUE
	READ(14,41,END=3000) MM,NS,KE,CAS,SAS
	CAS=1.D-12*CAS
	SAS=1.D-12*SAS
	IF (NS.LT.0) NS=-NS
   41	FORMAT(3I3,2D20.11)
	IF (MM.EQ.0) GO TO 1
	IF (MM.GT.MCSW) GO TO 1
	IF ((NS.GT.MKSI).OR.(KE.GT.META)) GO TO 1
C
	GO TO 305
C
 3000	IEND=1
	GO TO 303
C
  305	CONTINUE
	IF (MM.EQ.INM) GO TO 301
C
	IF (INM.GE.0) GO TO 303	
  304	INM=MM
	DO 102 K=1,4
		DO 102 I=1,MAPF
			UVC(K,I)=0.
			UVS(K,I)=0.
			WC(K,I)=0.
  102			WS(K,I)=0.
C
  301		CALL KSITAP(NS,KE,CAS,W,V,UVC)
		CALL KSITAP(NS,KE,SAS,W,V,UVS)
  302	CONTINUE
	GO TO 1
C
  303	CONTINUE
C
	NGAR=0
	NSEQ=0
	BCS='C'
	BSC='S'
C
			DO 300 IAB=1,4
C
	IF (IAB.EQ.1) GO TO 6091
	IF (IAB.EQ.3) GO TO 6093
C
		GO TO 60924
C
 6091		CONTINUE
C
		DO 6092 K=1,4
			DO 6092 I=1,MAPF
				WC(K,I)=0.D0
 6092				WS(K,I)=0.D0
C
		CALL CSFIWP(INM,UVC,C,S,WC,WS)
C
		GO TO 60924
C
 6093		CONTINUE
C
		DO 6094 K=1,4
			DO 6094 I=1,MAPF
				WC(K,I)=0.D0
 6094				WS(K,I)=0.D0
C
		CALL CSFIWP(INM,UVS,C,S,WC,WS)
C
60924		CONTINUE
C
	DO 309 K=1,4
		DO 309 I=1,MAPU
			A(K,I)=0.
			B(K,I)=0.
                  IF (I.LE.MIFI) G(K,I)=0.
  309	CONTINUE
C
	IRM=-INM
	IF((IAB.EQ.2).OR.(IAB.EQ.4)) IRM=INM
	IRA=-IRM
	IF (IAB.EQ.3) BCS='S'
	IF (IAB.EQ.3) BSC='C'
	II=-MINFI*MAPA-MAXPSI+1
	I3=0
	DO 108 I=1,MFIW
		II=II+MAPA
		DO 108 I2=1,MPSIW
	I4=II+I2-1
	I5=II-I2+1
	I3=I3+1
			DO 109 K=1,4
	IF (IAB.EQ.1) R=WC(K,I3)-WS(K,I3)
	IF (IAB.EQ.2) R=WC(K,I3)+WS(K,I3)
	IF (IAB.EQ.3) R=WS(K,I3)-WC(K,I3)
	IF (IAB.EQ.4) R=WS(K,I3)+WC(K,I3)
		R=0.5*R
		A(K,I4)=R
		IF (I2.NE.1) A(K,I5)=R
  109			CONTINUE
  108	CONTINUE
	RA=IRA*FREZ
C
	CALL KENGP(IRM,RA,A,B,ADFI,FREQ,PFU,IAN,G)
C
	IFI=MINFI
	IPS=-MAXPSI
	DO 211 I=1,MAPU
		IPS=IPS+1
		IF (IPS.LT.MAXPSI) GO TO 212
		IPS=-MAXPSI+1
		IFI=IFI+1
  212		CONTINUE
		DO 221 K=1,4
			RW(K)=B(K,I)
		IF (BCS.EQ.'S') RW(K)=-RW(K)
  221		CONTINUE
		DO 5221 K=2,4
			R=DABS(RW(K))
			IF (R.GT.RMIN) GO TO 5223
 5221		CONTINUE
		GO TO 213
 5223		CONTINUE
      	WRITE(15) IFI,IPS,IRM,IRA,
     *		ILA,IL,ILS,IF,ID,
     *		(RW(K),K=1,4),BSC
		NTERM=NTERM+1
		NGAR=NGAR+1
  213		CONTINUE
  211	CONTINUE
C
C SEQULAR PERTURBATIONS: NEW FUNCTION
C
	IFI=MINFI-1
	DO 214 I=1,MIFI
		IFI=IFI+1
		IPER=IFI
            DO 524 K=2,4
                  R=G(K,I)
      		IF (DABS(R).GT.1.E-18) GO TO 525
  524       CONTINUE
                  GO TO 526
  525       CONTINUE
	WRITE(16) IAN,IPER,IRM,IRA,
     *		ILA,IL,ILS,IF,ID,
     *		(G(K,I),K=1,4),BCS
            NTERS=NTERS+1
            NSEQ=NSEQ+1
  526       CONTINUE
  214	CONTINUE
C
  300		CONTINUE
 4444	FORMAT(1X,'Degree  ',I4,' :',I4,' sh.terms',
     *			' :',I4,'  sec.terms')
	PRINT 4444,INM,NGAR,NSEQ
	WRITE(17,4444) INM,NGAR,NSEQ
C
	IF (IEND.EQ.0) GO TO 304
C
	PRINT 6665,NTERM
	WRITE(17,6665) NTERM
 6665	FORMAT(1X,'in File CTAC.DAT are added',I6,' short terms')
	PRINT 7665,NTERS
	WRITE(17,7665) NTERS
 7665	FORMAT(1X,'in File CTAC.SEQ are added',I6,'  long terms')
	RETURN
	END
C
	SUBROUTINE PCMLUS(CC,ADFI,PFU,RMIN,DELTA,
     *			W,U,V,C,S,UV,WC,WS,A,B,G)
	IMPLICIT REAL*8(A-H,O-Z),INTEGER*2(I-N)
	DIMENSION CC(50),A(4,220),B(4,220),WC(4,96),WS(4,96),
     *		G(4,20),ADFI(4,24),PFU(4,60),ABC(4),RW(4),
     *		W(4,90),V(4,240),UV(4,96),U(4,90),
     *		C(4,240),S(4,240)
	CHARACTER BCS,BSC,BSAT(60)
C
	MPSIW=6
	MFIW=16
	MAXPSI=6
	MAXFI=16
	MINFI=-4
	MAPA=2*MAXPSI-1
	MIF=MAXFI-MINFI
	MAPF=MIF*MAPA
C
C DIMENSIONS OF A,B  IS (-MINFI+MAXFI)*MAPA,
C WC AND WS IS MFIW*MPSIW IN PROCESS OF READING
C G IS -MINFI+MAXFI
C
	FREZ=0.72921158E-4
	FREQ=FREZ/55.5E0
	IRT=0
C
	FREQ=CC(8)**2*FREQ
C
   45	FORMAT(18A1)
C
	READ(14,5262) BSAT
 5262	FORMAT(60A1)
 5263	FORMAT(1X,60A1)
C
	NTERM=0
	NTERS=0
C
	TIDEK2=0.3
C
	NON=0
	MON=0
    1	CONTINUE
	READ(14,41,END=100) KK,KTIDE,NN,MM,BCS
   41	FORMAT(4I3,1X,A1)
C
	IF ((NN.NE.NON).OR.(MM.NE.MON))	PRINT 61,NN,MM
c	IF ((NN.NE.NON).OR.(MM.NE.MON))	WRITE(17,61) NN,MM
	NON=NN
	MON=MM
   61	FORMAT(1X,'Now N=',I2,1X,'M=',I2)
   62	FORMAT(1A1)
C
	BSC='S'
	IF (BCS.EQ.'S') BSC='C'
	DO 102 K=1,4
		DO 102 I=1,96
			UV(K,I)=0.
			WC(K,I)=0.
  102			WS(K,I)=0.
C
	DO 103 KKK=1,KK
		READ(14,42) NS,KE,ASE
		NSNS=IABS(NS)
		IF (NS.LT.0) CALL KSITAP(NSNS,KE,ASE,W,V,UV)
		IF (NS.GE.0) CALL KSITAP(NSNS,KE,ASE,U,V,UV)
  103	CONTINUE
	IF (KTIDE.EQ.0) GO TO 1103
	DO 2103 KKK=1,KTIDE
		READ(14,42) NS,KE,ASE
		TIDASE=TIDEK2*ASE
		NSNS=IABS(NS)
		CALL KSITAP(NSNS,KE,TIDASE,W,V,UV)
 2103	CONTINUE
 1103	CONTINUE
   42	FORMAT(2I3,E16.6)
	IF (MM.EQ.0) GO TO 104
	CALL CSFIWP(MM,UV,C,S,WC,WS)
	GO TO 105
  104	CONTINUE
	DO 106 K=1,4
		DO 106 I=1,96
			WC(K,I)=UV(K,I)
  106			WS(K,I)=0.
  105	CONTINUE
	DO 107 K=1,4
		DO 107 I=1,96
			RC=WC(K,I)
			RS=WS(K,I)
			WC(K,I)=0.25*(RC+RS)
  107			WS(K,I)=0.25*(RC-RS)
C
	INM=0
	READ(14,41) NM,NMS
	PRINT 1441,NMS
 1441	FORMAT(1X,'the Solve for Row with the',I4,'  terms')
C
	ngarsu=0
	nseqsu=0
C
		DO 200 N=1,NMS
C
	READ(14,43) ILA,IL,ILS,IF,ID,SAB,RAB,RALF
   43	FORMAT(5I3,3E15.6)
C
	SAB=1.D-12*DELTA*SAB
	RAB=1.D-12*DELTA*RAB
	INM=INM+1
	NGAR=0
	NSEQ=0
	IF (BCS.EQ.'C') GO TO 110
		ABC(1)=SAB
		ABC(2)=-RAB
		ABC(3)=RAB
		ABC(4)=-SAB
		GO TO 111
  110	CONTINUE
		ABC(1)=RAB
		ABC(2)=SAB
		ABC(3)=SAB
		ABC(4)=RAB
  111	CONTINUE
C
		IAB1=1
		IAB4=4
		IABST=1
		ABSALF=ABS(RALF)
		IF (MM.NE.0) GO TO 3311
		IF (ABSALF.GT.1.D-15) GO TO 3312
		IAB4=1
		ABC(1)=4.*ABC(1)
		GO TO 3313
 3312		CONTINUE
		IAB4=2
		ABC(1)=2.*ABC(1)
		ABC(2)=2.*ABC(2)
		GO TO 3313
 3311		CONTINUE
		IF (ABSALF.GT.1.D-15) GO TO 3313
		IABST=2
		ABC(1)=2.*ABC(1)
		ABC(3)=2.*ABC(3)
 3313		CONTINUE
C
	IRM=MM
	IRA=1
			DO 300 IAB=IAB1,IAB4,IABST
C
	DO 309 K=1,4
		DO 309 I=1,MAPF
			IF (I.LE.MIF) G(K,I)=0.
			A(K,I)=0.
  309			B(K,I)=0.
C
		RABC=ABC(IAB)
	IF (IAB.EQ.2) IRA=-1
	IF (IAB.EQ.3) IRM=-MM
	IF (IAB.EQ.3) IRA=1
	IF (IAB.EQ.4) IRA=-1
	II=-MINFI*MAPA-MAXPSI+1
	IW=0
	DO 108 I=1,MFIW
		II=II+MAPA
		DO 108 I2=1,MPSIW
	I4=II+I2-1
	I5=II-I2+1
	IW=IW+1
			DO 109 K=1,4
		IF (IAB.LE.2) R=WC(K,IW)
		IF (IAB.GE.3) R=WS(K,IW)
		R=RABC*R
		A(K,I4)=R
		IF (I2.NE.1) A(K,I5)=R
  109			CONTINUE
  108	CONTINUE
	RA=IRA*RALF
	NILA=IRA*ILA
	NIL=IRA*IL
	NILS=IRA*ILS
	NIF=IRA*IF
	NID=IRA*ID
C
	CALL KENGP(IRM,RA,A,B,ADFI,FREQ,PFU,IAN,G)
C
C SHORT PERIOD PERTURBATIONS
C
	IFI=MINFI
	IPS=-MAXPSI
	DO 211 I=1,MAPF
		IPS=IPS+1
		IF (IPS.LT.MAXPSI) GO TO 212
		IPS=-MAXPSI+1
		IFI=IFI+1
  212		CONTINUE
		DO 221 K=1,4
			RW(K)=B(K,I)
		IF (BCS.EQ.'S') RW(K)=-RW(K)
  221		CONTINUE
		DO 5221 K=2,4
			R=ABS(RW(K))
			IF (R.GT.RMIN) GO TO 5223
 5221		CONTINUE
		GO TO 213
 5223		CONTINUE
	WRITE(15) IFI,IPS,IRM,IRT,
     *	NILA,NIL,NILS,NIF,NID,
     *		(RW(K),K=1,4),BSC
		NTERM=NTERM+1
		NGAR=NGAR+1
		ngarsu=ngarsu+1
  213		CONTINUE
  211	CONTINUE
C
C SEQULAR PERTURBATIONS: NEW FUNCTION
C
	IFI=MINFI-1
	DO 214 I=1,MIF
		IFI=IFI+1
		IPER=IFI
		DO 571 K=2,4
			R=G(K,I)
			IF (DABS(R).GT.1.E-18) GO TO 572
  571		CONTINUE
			GO TO 573
  572		CONTINUE
	WRITE(16) IAN,IPER,IRM,IRT,
     *		NILA,NIL,NILS,NIF,NID,
     *		(G(K,I),K=1,4),BCS
		NTERS=NTERS+1
		NSEQ=NSEQ+1
		nseqsu=nseqsu+1
  573		CONTINUE
  214	CONTINUE
C
  300		CONTINUE
c	PRINT 63,INM,ILA,IL,ILS,IF,ID,SAB,RAB,RALF,NGAR,NSEQ
c	WRITE(17,83) INM,ILA,IL,ILS,IF,ID,SAB,RAB,RALF,NGAR,NSEQ
   63	FORMAT(1H+,6I3,1P,2E11.1,1X,E12.2,' terms :',I5,I5)
   83	FORMAT(1H ,6I3,1P,2E11.1,1X,E12.2,' terms :',I5,I5)
C
  200		CONTINUE
	print 26262,non,mon,ngarsu,nseqsu
	write(17,26262) non,mon,ngarsu,nseqsu
26262	format(1X,'for N=',I2,' and M=',I2,
     *		' are',I5,' short,',I4,' sec. terms')
	GO TO 1
  100	CONTINUE
C
	PRINT 6665,NTERM
	WRITE(17,6665) NTERM
 6665	FORMAT(1X,'in File CTAC.DAT are added',I6,' short terms')
	PRINT 7665,NTERS
	WRITE(17,7665) NTERS
 7665	FORMAT(1X,'in File CTAC.SEQ are added',I6,'  long terms')
	RETURN
	END
C
	SUBROUTINE PCMNUT(C,ADAL,DUL)
	IMPLICIT REAL*8(A-H,O-Z),INTEGER*2(I-N)
	DIMENSION C(50),ADAL(30,3),DUL(5),DH(3),RW(4),RN(4)
	CHARACTER BSC,TEXT(80),BCS
C
C PROGRAMM FOR CLC THE GENERATED FUNCTION FROM THE EQUATOR'S MOTION
C
	GR=1.7453292519943296D-2
	SR=4.8481368110953599D-6
C
	BSC='C'
	BCS='S'
	IFI=0
	IPS=0
	IRM=1
	IRT=0
	ILA=0
	IL=0
	ILS=0
	IF=0
	ID=0
C
	AG1=C(17)
	AS=C(10)
	GG=AG1*AS
	Q=1.D0/(1.D0-C(40))
	Q1=Q*C(46)
	Q2=C(42)
	Q3=Q*C(44)
	RN(1)=GG
	DO 123 I=1,3
		J=I+1
  123		RN(J)=AS*ADAL(6,I)+AG1*ADAL(5,I)
	DO 10 I=1,3
   10		DH(I)=Q1*ADAL(22,I)+Q2*ADAL(24,I)+Q3*ADAL(28,I)
C
	FREZ=0.7292115D-4
	FREQ=FREZ/55.5D0
	EPS=GR*23.44137D0
	SEPS=DSIN(EPS)
	OPEN(UNIT=12,FILE='NUT.PGM',STATUS='OLD',ERR=5213)
	GO TO 5214
C
 5214	CONTINUE
	NSH=0
	NSQ=0
C
			IRM=0
			RR=-(46.12D0/365.25D0)*(SR/8.64D4)
			RW(1)=RR*C(7)
			RW(2)=0.D0
			RW(3)=0.D0
			RW(4)=RR
			WRITE(16) IFI,IPS,IRM,IRT,ILA,IL,ILS,IF,ID,
     *				(RW(I),I=1,4),BSC
			NSQ=NSQ+1
			IRM=1
			RR=(20.04D0*SR)/(365.25D0*8.64D4)
			DO 225 J=1,4
  225				RW(J)=RR*RN(J)
			WRITE(16) IFI,IPS,IRM,IRT,ILA,IL,ILS,IF,ID,
     *				(RW(I),I=1,4),BCS
			NSQ=NSQ+1
	READ(12,5262) TEXT
 5262	FORMAT(80A1)
 5263	FORMAT(1X,80A1)
C
    1	READ(12,11,END=2) IOM,IL,ILS,IF,ID,D,DD,E,DE
C
   11	FORMAT(5I3,4F10.4)
	D=D-0.1D0*DD
	E=E-0.1D0*DE
	D=SR*D
	E=SR*E
	ILA=IOM
	IF=IF-IOM
	RALF=ILA*DUL(1)+IL*DUL(2)+ILS*DUL(3)+IF*DUL(4)+ID*DUL(5)
	DO 20 K=1,2
		IF (K.EQ.2) GO TO 22
		   R=1.D0/(C(44)+RALF)
		   RR=0.5D0*RALF*(D*SEPS+E)
		GO TO 23
   22		CONTINUE
		   R=1.D0/(C(44)-RALF)
		   RR=0.5D0*RALF*(D*SEPS-E)
		   ILA=-ILA
		   IL=-IL
		   ILS=-ILS
		   IF=-IF
		   ID=-ID
   23		CONTINUE
		IF (DABS(RALF).GE.FREQ) GO TO 24
			DO 25 J=1,4
   25				RW(J)=RR*RN(J)
			WRITE(16) IFI,IPS,IRM,IRT,ILA,IL,ILS,IF,ID,
     *				(RW(I),I=1,4),BCS
				NSQ=NSQ+1
			GO TO 26
   24		RW(1)=-R*GG*RR
		DO 21 I=1,3
			J=I+1
	QQ=R*(-R*GG*DH(I)+AS*ADAL(6,I)+AG1*ADAL(5,I))*RR
   21			RW(J)=-QQ
		WRITE(15) IFI,IPS,IRM,IRT,ILA,IL,ILS,IF,ID,
     *			(RW(I),I=1,4),BSC
				NSH=NSH+1
   26			CONTINUE
   20	CONTINUE
	GO TO 1
    2	CLOSE(UNIT=12)
C
	PRINT 6665,NSH
	WRITE(17,6665) NSH
 6665	FORMAT(1X,'in File CTAC.DAT are added ',I4,' short terms')
	PRINT 7665,NSQ
	WRITE(17,7665) NSQ
 7665	FORMAT(1X,'in File CTAC.SEQ are added ',I4,'  long terms')
C
	GO TO 5219
 5213	PRINT *, 'no File NUT.PGM, the Solve without inercial Forces'
	WRITE(17,*) 'no File NUT.PGM, the Solve without inercial Forces'
 5219	RETURN
	END